# 오답노트 - Weave 프로젝트

## 기술 스택

### Frontend
- **Next.js 15.4.7** - React 기반 풀스택 프레임워크 (App Router)
- **React 19.1.0** - UI 라이브러리
- **TypeScript 5** - 정적 타입 검사
- **Tailwind CSS 4** - 유틸리티 기반 CSS 프레임워크

### AI/ML
- **OpenAI API (v5.12.2)** - GPT 모델 연동
- **Google Generative AI (v0.24.1)** - Gemini 모델 연동

### Development Tools
- **Turbopack** - Next.js 개발 서버 (빠른 빌드)
- **ESLint** - 코드 품질 관리

### 배포 환경
- **Vercel** - Next.js 최적화 배포 플랫폼 (예정)

---

## 1. Event handlers cannot be passed to Client Component props

### 오류 상황
- Server Component에서 Client Component로 함수(이벤트 핸들러)를 props로 전달 시도
- Next.js App Router에서는 서버 컴포넌트가 기본값

### 해결 방법
- 이벤트 핸들러를 사용하는 컴포넌트에 'use client' 지시어 추가
- 또는 이벤트 핸들러를 클라이언트 컴포넌트 내부로 이동

### 적용 코드
```tsx
'use client'; // 파일 최상단에 추가

export default function Page() {
  // 이벤트 핸들러 사용 가능
}
```

## 2. API Route 500 Internal Server Error

### 오류 상황
- API 라우트에서 import 문을 파일 최상단에 사용 시 초기화 오류 발생
- Next.js의 API 라우트 컴파일 과정에서 모듈 로딩 이슈

### 해결 방법
- 동적 import 사용하여 런타임에 모듈 로드
- try-catch로 에러 핸들링 강화
- 에러 메시지를 클라이언트에 전달하여 디버깅 용이

### 적용 코드
```typescript
// 기존 (문제 발생)
import OpenAI from 'openai';
const openai = new OpenAI({...});

// 수정 (해결)
const { default: OpenAI } = await import('openai');
const openai = new OpenAI({...});
```

## 3. Invalid MIME type 오류 (OpenAI Vision API)

### 오류 상황
- OpenAI Vision API에서 "400 Invalid MIME type. Only image types are supported" 오류
- OpenAI의 Vision API는 이미지만 지원, PDF나 다른 형식 미지원

### 해결 방법
- Gemini 2.5 Flash Lite 모델로 변경 (멀티모달 지원)
- 이미지, PDF, 오디오, 비디오 모두 처리 가능
- 더 저렴한 비용으로 다양한 파일 형식 처리

### 적용 코드
```typescript
// Gemini 2.5 Flash Lite - 데이터 추출 (멀티모달)
const model = genAI.getGenerativeModel({ 
  model: 'gemini-2.5-flash-lite'
});

// Gemini 2.5 Pro - 문서 생성 (고품질)
const model = genAI.getGenerativeModel({ 
  model: 'gemini-2.5-pro' 
});
```

## 4. document.createElement is not a function 오류

### 오류 상황
- 클라이언트 컴포넌트에서 document 객체 사용 시 오류 발생
- 'use client' 지시어가 있어도 일부 상황에서 서버 사이드 렌더링 중 실행될 수 있음
- Next.js의 hydration 과정에서 발생 가능

### 해결 방법
- window와 document 객체 사용 전 브라우저 환경 체크
- 전역 객체 앞에 window. 명시적 사용
- appendChild/removeChild로 DOM 조작 시 안전하게 처리

### 적용 코드
```typescript
// 문제 발생 코드
const link = document.createElement('a');
link.click();
URL.revokeObjectURL(url);

// 해결 코드
if (typeof window === 'undefined' || typeof document === 'undefined') {
  console.error('브라우저 환경이 아닙니다.');
  return;
}

const link = window.document.createElement('a');
window.document.body.appendChild(link);
link.click();
window.document.body.removeChild(link);
window.URL.revokeObjectURL(url);
```