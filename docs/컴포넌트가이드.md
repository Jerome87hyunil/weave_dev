# Weave 컴포넌트 가이드

## 개요
Weave 프로젝트의 재사용 가능한 컴포넌트 모음입니다. 각 컴포넌트는 독립적으로 사용 가능하며, 다른 프로젝트에도 쉽게 통합할 수 있도록 설계되었습니다.

## 컴포넌트 목록

### 1. AI Assistant 컴포넌트 (`/components/ai-assistant/`)

#### DataExtractor
영수증, 세금계산서 등의 이미지나 PDF에서 데이터를 추출합니다.

**사용 예시:**
```tsx
import { DataExtractor } from '@/components/ai-assistant';

<DataExtractor
  onDataExtracted={(data) => console.log('추출된 데이터:', data)}
/>
```

**주요 기능:**
- 이미지 및 PDF 파일 지원
- 드래그앤드롭 업로드
- Gemini 2.5 Flash Lite 모델 사용
- JSON 형식으로 데이터 추출
- 클립보드 복사 기능

#### DocumentGenerator
템플릿 기반으로 견적서, 계약서 등의 문서를 생성합니다.

**사용 예시:**
```tsx
import { DocumentGenerator } from '@/components/ai-assistant';

<DocumentGenerator
  onDocumentGenerated={(doc) => console.log('생성된 문서:', doc)}
/>
```

**주요 기능:**
- 다양한 템플릿 제공 (표준, 웹개발, 모바일앱, 디자인)
- 마크다운 에디터
- HTML 미리보기
- PDF 다운로드
- Word 문서 다운로드

#### DocumentEditor
마크다운 기반 문서 편집기입니다.

**사용 예시:**
```tsx
import { DocumentEditor } from '@/components/ai-assistant';

<DocumentEditor
  initialContent="# 제목"
  onSave={(content) => console.log('저장:', content)}
/>
```

### 2. 사업자 정보 조회 (`/components/business-info/`)

#### BusinessInfoLookup
사업자등록번호로 기업 정보를 조회합니다.

**사용 예시:**
```tsx
import { BusinessInfoLookup } from '@/components/business-info';

<BusinessInfoLookup
  onBusinessInfoFound={(info) => console.log('조회 결과:', info)}
/>
```

**주요 기능:**
- 사업자등록번호 유효성 검증
- 실시간 API 조회
- 상세 정보 표시
- 세금계산서 주소 포함

### 3. 이메일 시스템 (`/components/email/`)

#### DocumentRequestSystem
문서 제출 요청을 이메일로 발송하고 관리하는 통합 시스템입니다.

**사용 예시:**
```tsx
import { DocumentRequestSystem } from '@/components/email';

<DocumentRequestSystem />
```

**주요 기능:**
- 수신자 관리
- 문서 요청 발송
- 요청 내역 조회
- 업로드된 문서 확인/승인/거절
- 이메일 미리보기

#### RecipientManager
이메일 수신자를 관리하는 컴포넌트입니다.

**사용 예시:**
```tsx
import { RecipientManager } from '@/components/email';

<RecipientManager
  recipients={recipients}
  onRecipientsChange={(recipients) => setRecipients(recipients)}
  onReload={() => loadRecipients()}
/>
```

**주요 기능:**
- 수신자 추가
- 수신자 삭제
- 수신자 목록 표시
- 수신자 정보 수정

#### DocumentRequestForm
문서 요청을 작성하고 발송하는 폼 컴포넌트입니다.

**사용 예시:**
```tsx
import { DocumentRequestForm } from '@/components/email';

<DocumentRequestForm
  recipients={recipients}
  onRequestSent={() => console.log('요청 발송 완료')}
/>
```

**주요 기능:**
- 수신자 선택
- 프로젝트 정보 입력
- 문서 목록 관리
- 이메일 미리보기
- 문서 요청 발송

#### RequestHistory
발송된 문서 요청 내역을 표시하는 컴포넌트입니다.

**사용 예시:**
```tsx
import { RequestHistory } from '@/components/email';

<RequestHistory
  requests={documentRequests}
  recipients={recipients}
  onRecipientsLoad={() => loadRecipients()}
/>
```

**주요 기능:**
- 요청 내역 표시
- 상태별 필터링
- 이메일 미리보기
- 업로드 링크 복사

#### UploadedDocuments
업로드된 문서를 확인하고 관리하는 컴포넌트입니다.

**사용 예시:**
```tsx
import { UploadedDocuments } from '@/components/email';

<UploadedDocuments
  requests={documentRequests}
  onStatusUpdate={() => loadDocumentRequests()}
/>
```

**주요 기능:**
- 업로드된 문서 목록
- 문서 승인/거절
- 거절 사유 입력
- 문서 미리보기

#### EmailPreviewModal
발송될 이메일을 미리보기합니다.

**사용 예시:**
```tsx
import { EmailPreviewModal } from '@/components/email';

<EmailPreviewModal
  isOpen={showPreview}
  onClose={() => setShowPreview(false)}
  previewData={emailData}
/>
```

### 4. 문서 업로드 시스템 (`/components/document-upload/`)

#### FileUploadDropzone
드래그앤드롭이 가능한 파일 업로드 컴포넌트입니다.

**사용 예시:**
```tsx
import { FileUploadDropzone } from '@/components/document-upload';

<FileUploadDropzone
  documentId="doc1"
  documentName="사업자등록증"
  onUpload={async (file) => {
    // 파일 업로드 처리
    await uploadFile(file);
  }}
  maxSize={10} // MB
  acceptedTypes={['image/jpeg', 'application/pdf']}
/>
```

**주요 기능:**
- 드래그앤드롭 지원
- 파일 크기/형식 검증
- 업로드 진행 상태 표시
- 파일 미리보기
- 업로드 전 취소 가능

#### DocumentUploadPage
고객이 문서를 업로드하는 전체 페이지 컴포넌트입니다.

**사용 예시:**
```tsx
import { DocumentUploadPage } from '@/components/document-upload';

<DocumentUploadPage
  token="upload-token-123"
  onTokenError={(error) => console.error('토큰 오류:', error)}
  onUploadComplete={() => console.log('업로드 완료')}
/>
```

**주요 기능:**
- 토큰 기반 접근 제어
- 문서 목록 표시
- 각 문서별 업로드 상태 관리
- 필수 문서 체크
- 승인/거절 상태 표시

### 5. 템플릿 선택기 (`/components/`)

#### ContractTemplateSelector
계약서 템플릿을 선택하는 컴포넌트입니다.

**사용 예시:**
```tsx
import { ContractTemplateSelector } from '@/components/contract-templates';

<ContractTemplateSelector
  onTemplateSelect={(template) => console.log('선택된 템플릿:', template)}
/>
```

#### QuoteTemplateSelector
견적서 템플릿을 선택하는 컴포넌트입니다.

**사용 예시:**
```tsx
import { QuoteTemplateSelector } from '@/components/quote-templates';

<QuoteTemplateSelector
  onTemplateSelect={(template) => console.log('선택된 템플릿:', template)}
/>
```

### 6. 통합 컴포넌트 (`/components/`)

#### WeaveAssistant
모든 기능을 통합한 메인 컴포넌트입니다.

**사용 예시:**
```tsx
import { WeaveAssistant } from '@/components';

// 모든 탭 활성화
<WeaveAssistant />

// 특정 탭만 활성화
<WeaveAssistant
  tabs={['dataExtraction', 'documentGeneration']}
  defaultTab="dataExtraction"
/>
```

**설정 가능한 탭:**
- `dataExtraction`: 데이터 추출
- `documentGeneration`: 문서 생성
- `businessLookup`: 사업자 조회
- `documentRequest`: 문서 요청

## 모듈형 아키텍처

### 구조
```
components/
├── ai-assistant/           # AI 기반 기능
│   ├── DataExtractor.tsx
│   ├── DocumentGenerator.tsx
│   ├── DocumentEditor.tsx
│   └── index.ts
├── business-info/          # 사업자 정보
│   ├── BusinessInfoLookup.tsx
│   └── index.ts
├── email/                  # 이메일 시스템
│   ├── DocumentRequestSystem.tsx   # 통합 시스템
│   ├── RecipientManager.tsx        # 수신자 관리
│   ├── DocumentRequestForm.tsx     # 요청 폼
│   ├── RequestHistory.tsx          # 요청 내역
│   ├── UploadedDocuments.tsx       # 업로드 문서
│   ├── EmailPreviewModal.tsx       # 이메일 미리보기
│   └── index.ts
├── document-upload/        # 문서 업로드
│   ├── FileUploadDropzone.tsx
│   ├── DocumentUploadPage.tsx
│   └── index.ts
├── tabs/                   # 탭 모듈
│   ├── DataExtractionTab.tsx
│   ├── DocumentGenerationTab.tsx
│   ├── BusinessLookupTab.tsx
│   ├── DocumentRequestTab.tsx
│   └── index.ts
└── WeaveAssistant.tsx      # 통합 컴포넌트
```

### 장점
1. **독립성**: 각 컴포넌트는 독립적으로 작동
2. **재사용성**: 다른 프로젝트에 쉽게 이식 가능
3. **유지보수성**: 기능별로 분리되어 관리 용이
4. **확장성**: 새로운 기능 추가가 간편
5. **타입 안정성**: TypeScript로 완벽한 타입 지원

## API 연동

### 필요한 API 엔드포인트

#### AI Assistant
- `POST /api/ai-assistant`: 데이터 추출 및 문서 생성

#### Business Info
- `GET /api/business-info`: 사업자 정보 조회

#### Email System
- `GET/POST /api/email/recipients`: 수신자 관리
- `POST /api/email/document-request`: 문서 요청 발송
- `POST /api/email/preview`: 이메일 미리보기
- `PATCH /api/email/document-request/[id]/documents/[docId]`: 문서 상태 업데이트

#### Document Upload
- `GET /api/upload/validate`: 토큰 검증
- `POST /api/upload/document`: 파일 업로드

## 환경 변수

```env
# AI 서비스
GEMINI_API_KEY=your_gemini_api_key

# 사업자 정보 API
BUSINESS_API_KEY=your_business_api_key

# 이메일 서비스 (선택)
RESEND_API_KEY=your_resend_api_key

# 앱 설정
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

## 설치 및 사용

### 설치
```bash
npm install
```

### 개발 모드
```bash
npm run dev
```

### 프로덕션 빌드
```bash
npm run build
npm run start
```

## 커스터마이징

### 스타일 변경
모든 컴포넌트는 Tailwind CSS를 사용합니다. 클래스를 수정하여 스타일을 변경할 수 있습니다.

### 기능 확장
각 컴포넌트는 props를 통해 동작을 커스터마이징할 수 있습니다.

```tsx
// 예: 파일 업로드 제한 변경
<FileUploadDropzone
  maxSize={20} // 20MB로 변경
  acceptedTypes={['image/*', 'application/pdf', 'application/msword']}
/>
```

## 라이선스
MIT License - 자유롭게 사용 및 수정 가능합니다.